<div *ngIf="catsLoaded" id="steps">
  <span *ngFor="let step of steps;let i = index" class="m-2" [ngClass]="i===selectedCategory?'fw-bold':''">
    <div class="bg-primary rounded-circle text-white text-center p-1 d-inline" [ngClass]="!step.visited?'bg-dark':''" >
      {{i+1}}
    </div>
    <a role="button" (click)="changeStepInfo(i)" class="nav-link d-inline" [class.disabled]="!step.visited" [ngClass]="step.visited?'active text-primary':''">
      {{step.name}}
    </a>
  </span>
</div>
<div *ngIf="finish">
  <button class="btn btn-success" (click)="finishBuy()">finish</button>
</div>
<div class="row" *ngIf="catsLoaded">
  <div *ngIf="selectedCategory>0 && steps[selectedCategory]; else budget" class="col-10">
    {{steps[selectedCategory].description}}
    <label>price</label>
    <input #price type="number" class="form-control w-25" min="1" value="1000">
    <label>quantity</label>
    <input #quantity type="number" class="form-control w-25" min="1" value="1">
    <button class="btn btn-success" (click)="getProducts(+price.value)">filter</button>
    <div *ngIf="!proceedAfterInsufficientMoney && filterPriceHigh" class="alert alert-warning w-25">entered price are higher than remaining money</div>
    <div *ngFor="let prd of products" (click)="selectProduct(prd,+quantity.value)">
      {{prd.name}} : {{prd.price}}$ : {{prd.discount}}$
    </div>
  </div>

<!--                                                                            7000       6000      10000
  check make user choose to proceed if he exceeded money and increase total (prdprice - remaining + total)
  handle last step make it a new step
-->
  <ng-template #budget class="col-10">
    <!-- <input class="form-control w-25" type="number" [(ngModel)]="totalPrice" min="1000"> -->
    <input #total class="form-control w-25" [value]="totalPrice" type="number" min="1000">
    <!-- #region new -->
    <div *ngIf="lowPRiceBcRemaining" class="alert alert-danger w-25">you can't make total price less than total cost ({{totalCost}})</div>
    <!-- #endregion -->
    <div *ngIf="lowPrice" class="alert alert-danger w-25">not avaliable for less than 10,000$</div>
    <button class="btn btn-success w-25" (click)="setTotalPrice(+total.value)">Let's go!</button>
  </ng-template>


  <div class="col-2">
    <!-- beign edited -->
    <div *ngIf="!proceedAfterInsufficientMoney;else totalAfterProceed">
      Budget:{{totalPrice}}
    </div>
    <ng-template #totalAfterProceed>
      Budget2:{{totalCost}}
    </ng-template>
    <div *ngIf="!proceedAfterInsufficientMoney">
      <div *ngIf="remainingPrice>0;else insufficient">
        Remaining:{{remainingPrice}}
      </div>
      <ng-template #insufficient>
        Remaining: insufficient money
      </ng-template>
    </div>
    <!--end edited -->
    <div *ngFor="let prd of selectedProducts">
      {{prd.product.name}} x {{prd.quantity}}
    </div>
  </div>
</div>
